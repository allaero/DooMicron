####################################################################################################
##################################### STEPPER MOTOR SYSTEM #########################################
####################################################################################################

####################################################################################################
################################### COREXY X/Y STEPPER MOTORS ######################################
####################################################################################################

####################################################################################################
################################### X STEPPER (B MOTOR) ############################################
####################################################################################################

[stepper_x]                                                    # X-axis stepper motor configuration (B motor in CoreXY)
step_pin: X_STEP                                               # Step signal pin
dir_pin: X_DIR                                                 # Direction control pin
enable_pin: !X_EN                                              # Enable pin (inverted)
microsteps: 32                                                 # Microstepping resolution
rotation_distance: 32                                          # Distance per full rotation (mm)
full_steps_per_rotation: 200                                   # Steps per revolution (1.8° stepper)
endstop_pin: EBBCan:X_ENDSTOP                                  # Physical endstop switch pin
position_min: 0                                                # Minimum X position
position_endstop: 170                                          # Endstop position coordinate
position_max: 170                                              # Maximum X position
homing_speed: 80                                               # Homing movement speed (mm/s)
homing_retract_dist: 0                                         # Sensorless homing - no retraction
homing_positive_dir: true                                      # Home toward positive direction

[tmc2209 stepper_x]                                            # TMC2209 stepper driver configuration for X-axis
uart_pin: X_CS                                                 # UART communication pin
diag_pin: EBBCan:X_ENDSTOP                                     # Diagnostic pin for sensorless homing
run_current: 1                                                 # Operating current (A)
#sense_resistor: 0.110                                         # Current sense resistor value
stealthchop_threshold: 0                                       # StealthChop disabled (always SpreadCycle)
#driver_SGTHRS: 128                                            # StallGuard threshold for sensorless homing

# Optional TMC auto-tuning configuration (currently disabled)
#[autotune_tmc stepper_x]
#motor: moons-ms14hs5p4150                                     # Motor model for automatic TMC tuning


####################################################################################################
################################### Y STEPPER (A MOTOR) ############################################
####################################################################################################

[stepper_y]                                                    # Y-axis stepper motor configuration (A motor in CoreXY)
step_pin: Y_STEP                                               # Step signal pin
dir_pin: Y_DIR                                                 # Direction control pin
enable_pin: !Y_EN                                              # Enable pin (inverted)
microsteps: 32                                                 # Microstepping resolution
rotation_distance: 32                                          # Distance per full rotation (mm)
endstop_pin: tmc2209_stepper_y:virtual_endstop                 # Sensorless homing virtual endstop
full_steps_per_rotation: 200                                   # Steps per revolution (1.8° stepper)
position_min: 0                                                # Minimum Y position
position_endstop: 190                                          # Endstop position coordinate
position_max: 190                                              # Maximum Y position
homing_speed: 80                                               # Homing movement speed (mm/s)
homing_retract_dist: 0                                         # Sensorless homing - no retraction
homing_positive_dir: true                                      # Home toward positive direction

[tmc2209 stepper_y]                                            # TMC2209 stepper driver configuration for Y-axis
uart_pin: Y_CS                                                 # UART communication pin
diag_pin: MCU_STOP_Y_ENDSTOP                                   # Diagnostic pin for sensorless homing
run_current: 1                                                 # Operating current (A)
sense_resistor: 0.110                                          # Current sense resistor value
stealthchop_threshold: 0                                       # StealthChop disabled (always SpreadCycle)
driver_SGTHRS: 120                                             # StallGuard threshold for sensorless homing

# Optional TMC auto-tuning configuration (currently disabled)
#[autotune_tmc stepper_y]
#motor: moons-ms14hs5p4150                                     # Motor model for automatic TMC tuning


####################################################################################################
#################################### QUAD Z-AXIS STEPPER MOTORS ####################################
####################################################################################################
# Z-motor layout for quad gantry leveling:
#   ----+----
#   | 6 | 7 |   (Z1 | Z2)
#   ----+----
#   | 5 | 8 |   (Z0 | Z3)
#   ----+----
#     Front

####################################################################################################
################################### Z0 STEPPER (MOTOR 5) ###########################################
####################################################################################################

[stepper_z]                                                    # Z0 stepper motor configuration (front left, primary Z-axis)
step_pin: Z_STEP                                               # Step signal pin
dir_pin: Z_DIR                                                 # Direction control pin
enable_pin: !Z_EN                                              # Enable pin (inverted)
rotation_distance: 32                                          # Distance per full rotation (mm)
gear_ratio: 64:16                                              # Lead screw gear reduction ratio
microsteps: 32                                                 # Microstepping resolution
endstop_pin: probe:z_virtual_endstop                           # Probe-based Z homing
position_max: 150                                              # Maximum Z position
position_min: -5                                               # Minimum Z position (below bed for probing)
homing_speed: 15                                               # Initial homing speed (mm/s)
second_homing_speed: 3                                         # Precision homing speed (mm/s)
homing_retract_dist: 3                                         # Retraction distance during homing

[tmc2209 stepper_z]                                            # TMC2209 stepper driver configuration for Z0
uart_pin: Z_CS                                                 # UART communication pin
interpolate: true                                              # Enable microstep interpolation
run_current: 1                                                 # Operating current (A)
sense_resistor: 0.110                                          # Current sense resistor value
stealthchop_threshold: 0                                       # StealthChop disabled (always SpreadCycle)

# Optional TMC auto-tuning configuration (currently disabled)
#[autotune_tmc stepper_z]
#motor: omc-17he15-1504s                                       # Motor model for automatic TMC tuning


####################################################################################################
################################### Z1 STEPPER (MOTOR 6) ###########################################
####################################################################################################

[stepper_z1]                                                   # Z1 stepper motor configuration (rear left)
step_pin: Z1_STEP                                              # Step signal pin
dir_pin: !Z1_DIR                                               # Direction control pin (inverted)
enable_pin: !Z1_EN                                             # Enable pin (inverted)
microsteps: 32                                                 # Microstepping resolution
rotation_distance: 32                                          # Distance per full rotation (mm)
gear_ratio: 64:16                                              # Lead screw gear reduction ratio

[tmc2209 stepper_z1]                                           # TMC2209 stepper driver configuration for Z1
uart_pin: Z1_CS                                                # UART communication pin
interpolate: true                                              # Enable microstep interpolation
run_current: 1                                                 # Operating current (A)
sense_resistor: 0.110                                          # Current sense resistor value
stealthchop_threshold: 0                                       # StealthChop disabled (always SpreadCycle)

# Optional TMC auto-tuning configuration (currently disabled)
#[autotune_tmc stepper_z1]
#motor: omc-17he15-1504s                                       # Motor model for automatic TMC tuning


####################################################################################################
################################### Z2 STEPPER (MOTOR 7) ###########################################
####################################################################################################

[stepper_z2]                                                   # Z2 stepper motor configuration (rear right)
step_pin: Z2_STEP                                              # Step signal pin
dir_pin: Z2_DIR                                                # Direction control pin
enable_pin: !Z2_EN                                             # Enable pin (inverted)
rotation_distance: 32                                          # Distance per full rotation (mm)
gear_ratio: 64:16                                              # Lead screw gear reduction ratio
microsteps: 32                                                 # Microstepping resolution

[tmc2209 stepper_z2]                                           # TMC2209 stepper driver configuration for Z2
uart_pin: Z2_CS                                                # UART communication pin
interpolate: true                                              # Enable microstep interpolation
run_current: 1                                                 # Operating current (A)
sense_resistor: 0.110                                          # Current sense resistor value
stealthchop_threshold: 0                                       # StealthChop disabled (always SpreadCycle)

# Optional TMC auto-tuning configuration (currently disabled)
#[autotune_tmc stepper_z2]
#motor: omc-17he15-1504s                                       # Motor model for automatic TMC tuning


####################################################################################################
################################### Z3 STEPPER (MOTOR 8) ###########################################
####################################################################################################

[stepper_z3]                                                   # Z3 stepper motor configuration (front right)
step_pin: Z3_STEP                                              # Step signal pin
dir_pin: !Z3_DIR                                               # Direction control pin (inverted)
enable_pin: !Z3_EN                                             # Enable pin (inverted)
rotation_distance: 32                                          # Distance per full rotation (mm)
gear_ratio: 64:16                                              # Lead screw gear reduction ratio
microsteps: 32                                                 # Microstepping resolution

[tmc2209 stepper_z3]                                           # TMC2209 stepper driver configuration for Z3
uart_pin: Z3_CS                                                # UART communication pin
interpolate: true                                              # Enable microstep interpolation
run_current: 1                                                 # Operating current (A)
sense_resistor: 0.110                                          # Current sense resistor value
stealthchop_threshold: 0                                       # StealthChop disabled (always SpreadCycle)

# Optional TMC auto-tuning configuration (currently disabled)
#[autotune_tmc stepper_z3]
#motor: omc-17he15-1504s                                       # Motor model for automatic TMC tuning


####################################################################################################
#################################### MMU SYSTEM (DISABLED) #########################################
####################################################################################################

# MMU stepper motor configuration (currently disabled)
#[stepper_mmu]                                                 # MMU stepper motor configuration (motor 4)
#step_pin: MMU_STEP                                            # Step signal pin
#dir_pin: MMU_DIR                                              # Direction control pin
#enable_pin: !MMU_EN                                           # Enable pin (inverted)
#rotation_distance: 32                                         # Distance per full rotation (mm)
#gear_ratio: 64:16                                             # Gear reduction ratio
#microsteps: 32                                                # Microstepping resolution

#[tmc2209 stepper_mmu]                                         # TMC2209 stepper driver configuration for MMU
#uart_pin: MMU_CS                                              # UART communication pin
#interpolate: true                                             # Enable microstep interpolation
#run_current: 1                                                # Operating current (A)
#sense_resistor: 0.110                                         # Current sense resistor value
#stealthchop_threshold: 0                                      # StealthChop disabled (always SpreadCycle)


####################################################################################################
##################################### MMU SERVO CONTROL ############################################
####################################################################################################

[servo my_servo]                                               # MMU servo motor for filament path selection
pin: MMU_SERVO                                                 # Servo control pin
maximum_servo_angle: 180                                       # Maximum servo rotation angle
minimum_pulse_width: 0.001                                     # Minimum PWM pulse width
maximum_pulse_width: 0.002                                     # Maximum PWM pulse width
#initial_angle:                                                # Initial servo position (optional)
#initial_pulse_width:                                          # Initial pulse width (optional)
